import Head from 'next/head'
import Image from 'next/image'
import Link from 'next/link'

import { Inter } from '@next/font/google'
import styles from '../styles/Home.module.css'
import axios from "axios"

const inter = Inter({ subsets: ['latin'] })

export default function Home({data}) {
  let {prof,repo} = data
  // console.log(prof,repo)

  return (
    <>
      <Head>
        <title>github protfolio</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <div style={{display:'flex'}}>
          <div>
              <Image src={prof.avatar_url} width={100} height={100} alt={prof.name} />
              {/* <img src={prof.avatar_url} width={100} height={100} alt={prof.name} /> */}

      
              <h2>@{prof.login}</h2>
              <h1>{prof.name}</h1>
               <p>{prof.bio}</p>
               <div style={{display:'flex'}}>
                <h3 style={{marginRight:"20px"}}>followers: {prof.followers}</h3>
                <h3>following: {prof.following}</h3>
                
               </div>
              <div>
                <button style={{margin:"10px", padding:"10px", borderRadius:"20%" }} >Resume</button>
                <Link href={prof.html_url}><button style={{margin:"10px", padding:"10px", borderRadius:"20%" }} >Follow</button></Link>
              </div>
              <div>
              {
                prof.bio.split("|").map((el)=>{
                    return <button key={el} style={{margin:"10px"}}>{el}</button>
                })
              }
              </div>
              <div>
                {
                  prof.company.split(" @").map((el)=>{
                    return (<div key={el}> <text>softwate Engineer at {el}</text><br /></div>)
                })
                }
              </div>

          </div>
{/* project part */} 
          <div>           
        <h1>Projects</h1>
                <div style={{display:'grid',gridTemplateColumns:'173px 173px 173px 173px',gap:"20px"}}>
                {   repo.items.map((el)=>{
                      return(
                        <div key={el.name} >
                          <Link href={el.html_url}><h2>{el.name}</h2></Link>
                          <div>
                            <p>fork: {el.forks_count}</p>
                          </div>
                          <p>{el.language}</p>
                          <p>{el.watchers_count}</p>
                          <p>following: {el.stargazers_count}</p>
                        </div>
                      )})
                  }   
                </div>
          </div>
        </div>
      </main>
    </>
  )
}

export async function getServerSideProps(){
  let res = await axios.get("https://api.github.com/users/riteshf") 
  let res2 = await axios.get("https://api.github.com/search/repositories?q=user:riteshf+fork:true&sort=updated&per_page=10&type=Repositories") 
  console.log(res.data)
  let data = {prof:res.data,repo:res2.data}
  return{
      props:{
          data:data
      }
  }
}